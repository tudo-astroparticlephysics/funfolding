language: python
python:
  - '3.5'
  - '3.6'
  - '2.7'

before_install:
  - export DISPLAY=:99.0
  - sh -e /etc/init.d/xvfb start
  - sudo rm -rf /dev/shm
  - sudo ln -s /run/shm /dev/shm
  - pip install --upgrade pip

install:
  - pip install flake8
  - pip install .

script:
  - flake8 funfolding
  - python setup.py test

deploy:
  provider: pypi
  user: tudo-app
  password:
    secure: "XQ9xd9/ALxyw1aqKgVCRktDRfPXsqX0QOKRg267hYhjMj6ycgP1JyN6BzCBx1bhhte5L/KGFvoEI+liGkezOh39lMzAW1SlQdi6L4xGDv1jTbGfjRviF0yniVXXx7PFnRO1M2b0IyxJRd49yWr66fJBmc7bM0szS56zakG5AL7QF1lWJ2V9EjXOAG5oANxhleHBhw41P6WgI7Z1IaojZAKb862++gsBE0TzVaVUSDRHXjo4md/ZZ9uxojULBMam6Lr+U1o1TPGCKirAGVaVzZo4xUh+/qrTHKpAQFmNUoa2j7NELmFpYdyymxJcFNw+OIQZk/AFVbeZe2oyjOgwAFQh89kXbBQhGcIsqOnaQxxPq01BtFAzopmacrmR7JkJBGDEJllHdAGhJUgAuZa5c1cQLPmxgnYeRuP79CjUdRHkB0OGeCPUxETph+B96gipDkSrrIOHdXXTNOI05Ew9vor7P0KaywjDm9gyI4nwBq3c6WXJNe0d4Ne9LpIsbwhzXW3v5eVB9+QH0RAwGm/An1ngMcz0+zBcqnKonsFtVuMIIYH9X8Y+1c5uSOXDZ6kNh8XR+Gg2mAUMfFi4Iq2XqE7HV7BP2/Pjx/n4Sx3RPLy8NRGA743WWOa8/GbiLodXB1zsvCNbHNFKjC+I2TihVGCpzlhE16TsM1xnFR0qNm20="
  skip_cleanup: true
  distributions: sdist
  on:
    branch: master
    tags: true
    condition: $TRAVIS_PYTHON_VERSION = "3.6"
